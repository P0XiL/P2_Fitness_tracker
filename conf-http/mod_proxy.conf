# Managed by Ansible - DO NOT EDIT
#
# Created 2021-11-23 by Jorgen Bjornstrup (jorgen@its.aau.dk)
#
# $Id: mod_proxy.conf.j2,v 1.4 2022/06/07 14:55:36 jorgen Exp $

# Apache proxy configurations for localhost daemons for use through
# the http://cs-24-sw-2-06.p2datsw.cs.aau.dk/ website.
#
# See the 00README.txt file for further information.

# Disable forward proxy usage
ProxyRequests off

# WebSocket reverse proxy configurations
RewriteEngine on
RewriteCond %{HTTP:Upgrade} websocket [NC]
RewriteCond %{HTTP:Connection} upgrade [NC]
RewriteRule ^/ws0/(.*)$ ws://localhost:4360/$1 [P]
RewriteRule ^/ws0/ - [F]
RewriteCond %{HTTP:Upgrade} websocket [NC]
RewriteCond %{HTTP:Connection} upgrade [NC]
RewriteRule ^/ws1/(.*)$ ws://localhost:4361/$1 [P]
RewriteRule ^/ws1/ - [F]
RewriteCond %{HTTP:Upgrade} websocket [NC]
RewriteCond %{HTTP:Connection} upgrade [NC]
RewriteRule ^/ws2/(.*)$ ws://localhost:4362/$1 [P]
RewriteRule ^/ws2/ - [F]
RewriteCond %{HTTP:Upgrade} websocket [NC]
RewriteCond %{HTTP:Connection} upgrade [NC]
RewriteRule ^/ws3/(.*)$ ws://localhost:4363/$1 [P]
RewriteRule ^/ws3/ - [F]
RewriteCond %{HTTP:Upgrade} websocket [NC]
RewriteCond %{HTTP:Connection} upgrade [NC]
RewriteRule ^/ws4/(.*)$ ws://localhost:4364/$1 [P]
RewriteRule ^/ws4/ - [F]
RewriteCond %{HTTP:Upgrade} websocket [NC]
RewriteCond %{HTTP:Connection} upgrade [NC]
RewriteRule ^/ws5/(.*)$ ws://localhost:4365/$1 [P]
RewriteRule ^/ws5/ - [F]
RewriteCond %{HTTP:Upgrade} websocket [NC]
RewriteCond %{HTTP:Connection} upgrade [NC]
RewriteRule ^/ws6/(.*)$ ws://localhost:4366/$1 [P]
RewriteRule ^/ws6/ - [F]
RewriteCond %{HTTP:Upgrade} websocket [NC]
RewriteCond %{HTTP:Connection} upgrade [NC]
RewriteRule ^/ws7/(.*)$ ws://localhost:4367/$1 [P]
RewriteRule ^/ws7/ - [F]
RewriteCond %{HTTP:Upgrade} websocket [NC]
RewriteCond %{HTTP:Connection} upgrade [NC]
RewriteRule ^/ws8/(.*)$ ws://localhost:4368/$1 [P]
RewriteRule ^/ws8/ - [F]
RewriteCond %{HTTP:Upgrade} websocket [NC]
RewriteCond %{HTTP:Connection} upgrade [NC]
RewriteRule ^/ws9/(.*)$ ws://localhost:4369/$1 [P]
RewriteRule ^/ws9/ - [F]

# WebSocket reverse proxy response headers adjustment configurations
ProxyPassReverse /ws0/ ws://localhost:4360/
ProxyPassReverse /ws1/ ws://localhost:4361/
ProxyPassReverse /ws2/ ws://localhost:4362/
ProxyPassReverse /ws3/ ws://localhost:4363/
ProxyPassReverse /ws4/ ws://localhost:4364/
ProxyPassReverse /ws5/ ws://localhost:4365/
ProxyPassReverse /ws6/ ws://localhost:4366/
ProxyPassReverse /ws7/ ws://localhost:4367/
ProxyPassReverse /ws8/ ws://localhost:4368/
ProxyPassReverse /ws9/ ws://localhost:4369/

# HTTP reverse proxy configurations
ProxyPass /node0/ http://localhost:3360/
ProxyPass /node1/ http://localhost:3361/
ProxyPass /node2/ http://localhost:3362/
ProxyPass /node3/ http://localhost:3363/
ProxyPass /node4/ http://localhost:3364/
ProxyPass /node5/ http://localhost:3365/
ProxyPass /node6/ http://localhost:3366/
ProxyPass /node7/ http://localhost:3367/
ProxyPass /node8/ http://localhost:3368/
ProxyPass /node9/ http://localhost:3369/

# HTTP reverse proxy response headers adjustment configurations
ProxyPassReverse /node0/ http://localhost:3360/
ProxyPassReverse /node1/ http://localhost:3361/
ProxyPassReverse /node2/ http://localhost:3362/
ProxyPassReverse /node3/ http://localhost:3363/
ProxyPassReverse /node4/ http://localhost:3364/
ProxyPassReverse /node5/ http://localhost:3365/
ProxyPassReverse /node6/ http://localhost:3366/
ProxyPassReverse /node7/ http://localhost:3367/
ProxyPassReverse /node8/ http://localhost:3368/
ProxyPassReverse /node9/ http://localhost:3369/
